## Limpieza y revisión inicial de los datos

```{r}
#|label: prep
#Librerías
library(tidyverse)
library(janitor)
library(skimr)
library(palmerpenguins)

df_raw <- penguins %>% as_tibble() # guardo raw para auditoría
```

```{r}
#|label: clean_names
df <- df_raw %>% clean_names()
names(df) # comprobar
```

```{r}
#|label: skim
skim(df) #Resumen rápido (estructura + NA)
```

```{r}
#|label: duplicates
n_dup <- sum(duplicated(df))
n_dup # Número de filas duplicadas

# si quieres, ver filas duplicadas (opcional)
df %>% filter(duplicated(.)) %>% head()

# eliminar duplicados exactos (opcional)
df <- df %>% distinct()

```
```{r}
#| label: consistencia de variables categóricas

#Variables categóricas
df %>% summarise(across(where(is.character), n_distinct))
df %>% summarise(across(where(is.factor), n_distinct))
df %>% count(species)
df %>% count(island)
df %>% count(sex)

#Tipos de variables (convertir a factor si hace falta)
df <- df %>% 
  mutate(species = as.factor(species),
         island  = as.factor(island),
         sex     = as.factor(sex))

#Revisar posibles inconsistencias de texto
unique(df$species)
unique(df$island)
unique(df$sex)

df1 <- df %>% select(-year) #Eliminar columnas innecesarias
```
